<div *ngIf="status!=null">
    <div class="d-flex justify-content-center my-3">
        <div class="alert alert-danger" role="alert">
            {{status!.error.message}} - {{status!.message}}
        </div>
    </div>
</div>


<div *ngIf="status==null">
    <div class="flex justify-center">
        <div class="shadow-lg bg-gray-800 p-16 rounded-3xl bg-opacity-95 text-xl">
            <div>
                <form [formGroup]="LoanForm" (ngSubmit)="onSubmit()" class="flex flex-col w-96">
                    <!--ID-->
                    <mat-form-field *ngIf="operation=='EDIT'">
                        <mat-label>ID:</mat-label>
                        <input matInput formControlName="id" placeholder="ID" required readonly>
                        <mat-hint align="end">(can't change this number)</mat-hint>
                    </mat-form-field>

                    <!-- Search book -->
                    <div>
                        <label for="book" class="float-left">Book</label>
                    </div>
                    <!-- Search Book-->
                    <div formGroupName="book">
                        <div class="form-group flex justify-between">
                            <mat-form-field [style.width.px]=280>
                                <mat-label>BOOK ID</mat-label>
                                <input matInput formControlName="id" placeholder="BOOK ID" required readonly>
                            </mat-form-field>

                            <button
                                class="h-14 w-24 bg-blue-900 hover:bg-blue-500 text-white-700 font-semibold hover:text-white border border-blue-900 hover:border-transparent rounded"
                                type="button" (click)="onShowBooksSelection()"> <i
                                    class="pi pi-search"></i><mat-icon>search</mat-icon></button>
                        </div>
                        <div class="mb-5">
                            "{{oLoan.book.title}}"<br>{{oLoan.book.author}}
                        </div>
                    </div>

                    <!-- Search user -->
                    <div>
                        <label for="user" class="float-left">User</label>
                    </div>
                    <div formGroupName="user">
                        <div class="form-group flex justify-between">
                            <mat-form-field [style.width.px]=280>
                                <mat-label>USER ID</mat-label>
                                <input matInput formControlName="id" placeholder="USER ID" required readonly>
                            </mat-form-field>

                            <button
                                class="h-14 w-24 bg-blue-900 hover:bg-blue-500 text-white-700 font-semibold hover:text-white border border-blue-900 hover:border-transparent rounded"
                                type="button" (click)="onShowUsersSelection()"> <i
                                    class="pi pi-search"></i><mat-icon>search</mat-icon></button>
                        </div>
                        <div class="mb-5">{{oLoan.user.name}}<br>{{oLoan.user.username}}</div>
                    </div>
                    
                    <!--Creation Date-->
                    <div class="" *ngIf="operation=='EDIT'">
                        <label for="creationDate" class="float-left">Creation Date</label>
                        <div class="text-black">
                            <p-calendar class="float-left" formControlName="creationDate" [locale]="es"
                                dateFormat="dd/mm/yy" inputId="spanish" [showIcon]="true" [showTime]="false"
                                [showSeconds]="true"></p-calendar>
                            <div *ngIf="hasError('creationDate', 'required')" class="text-danger"> You must
                                set a valid date
                            </div>
                        </div>
                    </div>

                    <!--Return Date-->

                    <div class="text-black float-left" *ngIf="oLoan.returnDate != null && operation != 'NEW'">
                        <label for="returnDate" class="float-left">Return Date</label>
                        <p-calendar class="float-left" formControlName="returnDate" [locale]="es" dateFormat="dd/mm/yy"
                            inputId="spanish" [showIcon]="true" [showTime]="false" [showSeconds]="false"></p-calendar>
                    </div>

                    <div class="text-red-600 " *ngIf="oLoan.returnDate == null">
                        <label for="returnDate" class="float-left">Not Returned Yet</label>
                        <p-calendar class="float-left" formControlName="returnDate" [locale]="es" dateFormat="dd/mm/yy"
                            inputId="spanish" [showIcon]="true" [showTime]="false" [showSeconds]="false"></p-calendar>
                    </div>
                    <!--Due Date-->
                    <div>
                        <label for="dueDate" class="float-left">Due Date</label>
                    </div>
                    <div class="text-black float-left">
                        <p-calendar class="float-left" formControlName="dueDate" [locale]="es" dateFormat="dd/mm/yy"
                            inputId="spanish" [showIcon]="true" [showTime]="false" [showSeconds]="false"></p-calendar>
                    </div>
                    

                    <button type="submit" [disabled]="!LoanForm.valid"
                        class="mt-10 bg-green-900 hover:bg-green-500 text-white-700 font-semibold hover:text-white py-2 px-4 border border-green-900 hover:border-transparent rounded">Save
                        Loan</button>
                </form>
            </div>
        </div>
    </div>
</div>